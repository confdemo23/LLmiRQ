PartitionTextFileWriter may leave in-use prefix/suffix behind
It looks like that when PartitionTextFileWriter is used with an idleTimeout and we have a lot of concurrency and context/jvm is killed, running task to close/rename file(when in-use prefix/suffix is used) gets killed and we either lose data or file ends up having in-use prefix/suffix.
This is caused by at least because of two things we don&amp;apos;t do, 1) in AbstractPartitionDataStoreWriter.doStop() we don&amp;apos;t call sub writes stop(), 2) in PollingTaskSupport.stop() we don&amp;apos;t wait underlying runningTask to finish.