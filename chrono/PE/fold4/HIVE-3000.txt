Potential infinite loop / log spew in ZookeeperHiveLockManager
See ZookeeperHiveLockManger.lock()
If Zookeeper is in a bad state, it&amp;apos;s possible to get an exception (e.g. org.apache.zookeeper.KeeperException$SessionExpiredException) when we call lockPrimitive(). There is a bug in the exception handler where the loop does not exit because the break in the switch statement gets out the switch, not the do..while loop. Because tryNum was not incremented due to the exception, lockPrimitive() will be called in an infinite loop, as fast as possible. Since the exception is printed for each call, Hive will produce significant log spew.