ProviderManager should not pass null authenitication to ConcurrentSessionController.checkAuthenticationAllowed()
It is valid for an AuthenticationProvider to return null, but this will cause ConcurrentSessionController to throw an exception. An extra null check is needed in ProviderManager.doAuthentication