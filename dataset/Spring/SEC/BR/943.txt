DefaultSpringSecurityContextSource should support escaped spaces in URL.
When working out the base name, it uses URI.getPath() when it should probably use URI.getRawPath(). Otherwise it gets confused by the returned space and assumes that there are multiple URLs in the string.