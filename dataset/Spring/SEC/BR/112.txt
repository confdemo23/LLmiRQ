Infinite loop when SecurityEnforcementFilter doesn&apos;t clear SecurityContextHolder
http://forum.springframework.org/showthread.php?t=19895
If a user is disabled midway through a session, and anonymous authentication is being used to authorize the login form URL, an infinite loop will occur. This is because a DisabledException is thrown by the AuthenticationManager, which SecurityEnforcementFilter will catch and then launch AuthenticationEntryPoint. However, the protected login form URL (ie generally marked as ROLE_ANONYMOUS) will not be authorized, because the AnonymousProcessingFilter will not replace the SecurityContextHolder contents as the SecurityContextHolder already contains an Authentication object (albeit one that is disabled).
The fix is for SecurityEnforcementFilter to clear the SecurityContextHolder before loading any AuthenticationEntryPoint.