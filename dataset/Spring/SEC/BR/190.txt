CaptchaSecurityContextImpl needs to override hashcode()
The HttpSessionContextIntegrationFilter only stores the SecurityContext into the session if the context has "changed" during the filter chain. It uses the hashcode() method to determine if the context has "changed". However, CapchaSecurityContextImpl does not override the default hashcode implementation from SecurityContextImpl, and therefore always returns -1 (assuming the authentication is null), even though the context is human.