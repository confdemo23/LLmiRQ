ClientPasswordAuthenticationProvider does not report bad credentials correctly
If username/password authentication fails, authenticate() throws a BadCredentialsException, which is not a subclass of OAuth2Exception. Therefore it does not render an OAuth-compliant JSON error response.
This is trivial to fix by wrapping the exception thrown by wrapping the BadCredentialsException. (I can supply a patch if needed.)