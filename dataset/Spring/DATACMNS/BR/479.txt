Regression in PersistentEntity detection for concrete Map types
A change introduced in Spring Data Commons 1.7.x to improve the detection of nested PersistentEntities causes concrete Map types being added to the MappingContext in case they are used as property type.
This is caused by PersistentProperty.isEntity() not excluding Map and Collection types anymore and PersistentProperty.getPersistentEntityTypes() adding the sole type to the list of returned types in a subsequent detection step.
We should ditch the check on isEntity() altogether and solely rely on the list of nested types being returned from getPersistentEntityTypes(). Ironically, master already has this implemented correctly due to the changes made for DATACMNS-243. Still we should forward port the slight change in the detection algorithm to keep them as consistent as possible.