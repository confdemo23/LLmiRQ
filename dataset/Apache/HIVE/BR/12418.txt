HiveHBaseTableInputFormat.getRecordReader() causes Zookeeper connection leak.
  @Override
  public RecordReader&lt;ImmutableBytesWritable, ResultWritable&gt; getRecordReader(
...
...
 setHTable(HiveHBaseInputFormatUtil.getTable(jobConf));
...
The HiveHBaseInputFormatUtil.getTable() creates new ZooKeeper connections(when HTable instance is created) which are never closed.