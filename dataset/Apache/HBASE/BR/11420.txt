ThriftServer (version 1) may crash on OOME
When using ThriftServer as a gateway for php &amp; c/c++ applications, I found it very easy to crash of OOME. I analyzed the jprof file and found that the ThriftServer had a 1.2G size byte array before it crashed. It seems to be a memory leak. But when did it happen? I checked the huge byte array and realized that it was a HTTP request string. That means a request in protocols other than Thrift may cause memory allocation exception. 
We cound easily recur the bug by wget/curl the ThriftServer. And we can check the memory usage infomation using TOP command.