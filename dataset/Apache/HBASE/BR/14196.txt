Thrift server idle connection timeout issue
When idle connection get cleaned from Thrift server, underlying table instances are still cached in a thread local cache.
This is the antipattern. Table objects are lightweight and should not be cached, besides this, underlying connections can be closed by periodic connection cleaner chore (ConnectionCache) and cached table instances may become invalid. This is Thrift1 specific issue. Thrift2 is OK.